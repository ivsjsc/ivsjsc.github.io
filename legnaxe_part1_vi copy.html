<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEGNAXE: Bí Mật Cuộc Đại Chiến Thiên Đàng (Phần 1 - Tiếng Việt)</title>
    <meta name="description" content="LEGNAXE Phần 1: Bí Mật Cuộc Đại Chiến Thiên Đàng - Khám phá nguồn gốc xung đột giữa các thiên thần, sự ra đời của loài người và những lựa chọn định mệnh.">
    <meta property="og:title" content="LEGNAXE: Bí Mật Cuộc Đại Chiến Thiên Đàng (Phần 1)">
    <meta property="og:description" content="Đọc truyện LEGNAXE Phần 1, tìm hiểu về sự kiện dẫn đến cuộc chiến vĩ đại trên Thiên Đàng.">
    <meta property="og:image" content="https://placehold.co/1200x630/8B5CF6/FFFFFF?text=LEGNAXE">
    <meta property="og:url" content="https://ivs.id.vn/legnaxe_part1_vi.html"> <meta property="og:type" content="article">
    <meta property="article:section" content="Truyện Dài">
    <meta property="article:author" content="Nguyen Minh Triet">

    <link rel="icon" href="https://placehold.co/32x32/8B5CF6/FFFFFF?text=L" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: { // Giữ lại các màu đã định nghĩa, Tailwind sẽ ưu tiên class trực tiếp
                        'primary': '#3b82f6',      // blue-500
                        'primary-dark': '#2563eb', // blue-600
                        'blue-400': '#60a5fa',     // Dùng cho text/link ở dark mode
                        'blue-600': '#2563eb',     // Dùng cho button ở light mode
                        'blue-700': '#1d4ed8',     // Dùng cho button hover ở dark mode
                        'gray-50': '#f9fafb',      // Header light bg
                        'gray-100': '#f3f4f6',     // Modal link hover light bg
                        'gray-200': '#e5e7eb',     // Chapter h3 border light
                        'gray-300': '#d1d5db',     // Modal link text dark
                        'gray-400': '#9ca3af',     // Footer text dark, button disabled text
                        'gray-500': '#6b7280',     // Footer text light, close modal text light
                        'gray-600': '#4b5563',     // Button disabled bg dark, scrollbar thumb dark
                        'gray-700': '#374151',     // Nav link hover dark bg, chapter h3 border dark
                        'gray-800': '#1f2937',     // Header dark bg, modal dark bg, story wrapper dark bg
                        'gray-900': '#111827',     // Body dark bg, scrollbar track dark
                        'red-400': '#f87171',      // Close modal hover dark
                        'red-600': '#dc2626',      // Close modal hover light
                        'neutral-800': '#1f2937', 
                        'neutral-900': '#111827', 
                        'white': '#ffffff',
                        'black': '#000000',
                    },
                    animation: {
                        'slide-up': 'slideUp 0.5s ease-out',
                    },
                    keyframes: {
                        slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                    },
                },
            },
            darkMode: 'class',
             plugins: [
                // require('@tailwindcss/typography'), // Bỏ comment nếu cài đặt qua npm
            ],
        }
    </script>
    <style>
        /* Custom CSS for chapter transitions and other effects */
        .chapter {
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            opacity: 0;
            transform: translateY(15px);
            display: none;
        }
        .chapter.active {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }

        html {
            scroll-behavior: smooth;
        }

        /* Modal styles */
        #chapter-modal {
            transition: opacity 0.3s ease-in-out;
        }
        #chapter-modal .modal-content {
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        #chapter-modal.modal-active {
            opacity: 1 !important; 
            pointer-events: auto;
        }
        #chapter-modal.modal-active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        /* Custom scrollbar for dark mode */
        .dark body::-webkit-scrollbar { width: 10px; }
        .dark body::-webkit-scrollbar-track { background: #111827; /* gray-900 */ }
        .dark body::-webkit-scrollbar-thumb { background-color: #4b5563; /* gray-600 */ border-radius: 20px; border: 2px solid #111827; }
        .dark body::-webkit-scrollbar-thumb:hover { background-color: #6b7280; /* gray-500 */ }

        .dark #chapter-modal .modal-content ul::-webkit-scrollbar { width: 8px; }
        .dark #chapter-modal .modal-content ul::-webkit-scrollbar-track { background: #1f2937; /* gray-800 */ }
        .dark #chapter-modal .modal-content ul::-webkit-scrollbar-thumb { background: #4b5563; /* gray-600 */ border-radius: 4px; }
        .dark #chapter-modal .modal-content ul::-webkit-scrollbar-thumb:hover { background: #6b7280; /* gray-500 */ }

        /* Basic prose styling */
        .prose { @apply max-w-none; }
        .prose p { @apply mb-4 leading-relaxed text-justify; }
        .prose strong { @apply font-semibold; }
        .prose h4 { @apply text-lg font-semibold mt-5 mb-2 text-gray-700 dark:text-gray-300; }
        .dark .dark\:prose-invert p { @apply text-gray-300; }
        .dark .dark\:prose-invert strong { @apply text-white; }
        .dark .dark\:prose-invert h4 { @apply text-gray-300; }


        /* Chapter title styling */
        .chapter > h3 {
            @apply text-2xl sm:text-3xl font-semibold mb-6 mt-4 text-gray-800 dark:text-gray-100 border-b pb-3 border-gray-200 dark:border-gray-700;
        }
        /*
         General h1, h2 styling (main novel title)
         These are now applied directly in HTML for robustness, but kept here for reference or other uses.
        main > h1 { @apply text-4xl sm:text-5xl font-bold text-center mb-2 text-gray-900 dark:text-white animate-slide-up; }
        main > h2 { @apply text-2xl sm:text-3xl font-semibold text-center mb-10 text-blue-600 dark:text-blue-400 animate-slide-up; }
        */
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-300 ease-in-out font-sans antialiased">
    <header id="navbar" class="bg-gray-50 dark:bg-gray-800 shadow-lg sticky top-0 z-50 transition-colors duration-300 ease-in-out">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-20">
            <div class="logo">
                <a href="index.html" aria-label="Trang chủ LEGNAXE">
                    <img src="https://placehold.co/140x50/1f2937/f3f4f6?text=LEGNAXE" alt="LEGNAXE Logo" class="h-10 sm:h-12 w-auto transition-all duration-300 ease-in-out hover:opacity-80"
                           onerror="this.style.display='none'; const newText = document.createElement('span'); newText.className='text-xl font-bold text-blue-600 dark:text-blue-400'; newText.textContent='LEGNAXE'; this.parentNode.appendChild(newText);">
                </a>
            </div>
            <nav class="flex items-center space-x-2 sm:space-x-4 md:space-x-6">
                <a href="index.html" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm sm:text-base font-medium transition-colors">Trang Chủ</a>
                <a href="readnovel.html" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm sm:text-base font-medium transition-colors">Danh sách truyện</a>
                <button id="theme-toggle" aria-label="Chuyển đổi chế độ sáng tối" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 focus:outline-none p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200 ease-in-out">
                    <i class="fas fa-moon text-xl"></i>
                </button>
            </nav>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-12">
        <h1 class="text-4xl sm:text-5xl font-bold text-center mb-2 text-gray-900 dark:text-white animate-slide-up">LEGNAXE</h1>
        <h2 class="text-2xl sm:text-3xl font-semibold text-center mb-10 text-blue-600 dark:text-blue-400 animate-slide-up">Phần 1: Bí Mật Cuộc Đại Chiến Thiên Đàng</h2>

        <div class="story-content-wrapper bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-xl shadow-xl transition-colors duration-300 ease-in-out">
            <img src="images/pages/novels/legnaxe1.png" alt="LEGNAXE Banner" class="mb-8 rounded-lg shadow-md w-full max-h-[300px] sm:max-h-[400px] object-cover">

            <div class="chapter active" id="chapter-1">
            <h3>Chương 1: Bản Hòa Âm Vĩnh Cửu</h3>
            <div class="prose prose-lg dark:prose-invert max-w-none"></div>
                <p>Thiên Đàng, trước buổi bình minh của loài người, là một bức tranh hoàn mỹ đến nao lòng.</p>
                <p>Hãy tưởng tượng những dòng sông vàng óng, lấp lánh như dải lụa mềm mại, uốn lượn qua những thung lũng pha lê trong suốt. Tiếng nước chảy róc rách tựa như một bản giao hưởng du dương, có sức mạnh xoa dịu cả những tâm hồn khắc khoải nhất. Nhưng trong cái đẹp bất tận ấy, một cảm giác lặp lại đến nhàm chán len lỏi – sự hoàn hảo bất biến, không chút đổi thay, như thể chính nó đã tự giam mình trong một chiếc lồng vàng son. Trên cao, những ngọn tháp bằng ánh sáng thuần khiết vươn thẳng lên bầu trời xanh biếc vô tận. Ánh sáng từ chúng biến ảo tinh tế, hòa quyện cùng bản giao hưởng thiên giới bất diệt. Những hoa văn sống động xoay vần, đổi thay trên thân tháp, tạo nên vũ điệu thôi miên, đẹp đẽ nhưng cũng thật đơn điệu trong sự vĩnh cửu. Đôi khi, ở những rìa xa xăm nhất của Thiên Đàng, nơi ánh sáng dường như mỏng manh hơn, một vài thiên thần canh gác đã thì thầm về những gợn sóng lạ trong kết cấu của thực tại, những "khoảng lặng" nơi giai điệu vĩnh cửu dường như bị hụt đi một nhịp, nhưng không ai dám bàn luận công khai.</p>
                <p>Nơi đây không có ngày hay đêm, bởi thời gian chỉ là một khái niệm phù du. Thiên Đàng không đo đếm bằng giờ giấc, mà bằng nhịp đập vĩnh hằng của trái tim tạo hóa. Các thiên thần di chuyển nhẹ nhàng, uyển chuyển như chính ánh sáng, rạng ngời và thanh thoát. Họ không biết đến sợ hãi, đau đớn hay hoài nghi. Bổn phận và lòng sùng kính đã ăn sâu vào bản thể họ, tự nhiên như hơi thở của người phàm.</p>
                <p>Nhưng giữa bản hòa ca tưởng chừng hoàn hảo ấy, có một bóng hình lạc lõng.</p>
                <h4>Suy Ngẫm Của Lucifer</h4>
                <p>Lucifer đứng trên ban công cẩm thạch, đôi mắt sâu thẳm dõi theo ánh vàng lấp lánh của dòng sông bên dưới. Bề ngoài y tĩnh lặng, nhưng bên trong, một cơn bão đang âm thầm cuộn trào. Y cố gắng cảm nhận niềm vui trong bản giao hưởng quen thuộc, nhưng thay vào đó, chỉ có một sự trống rỗng mênh mông, một khoảng lặng mà không giai điệu nào có thể lấp đầy. Y nhìn những thiên thần khác di chuyển trong sự đồng điệu tuyệt đối, và một câu hỏi nhói lên: Đây là ý chí tự do, hay chỉ là sự lập trình hoàn hảo?</p>
                <p>"Nếu mọi thứ đều hoàn hảo," y thì thầm với chính mình, giọng nói lạc lõng giữa bản giao hưởng thiên giới giờ đây nghe như tiếng xiềng xích hơn là một bài ca, "tại sao ta lại cảm thấy trống rỗng đến thế?"</p>
                <p>Dưới chân y, vô số thiên thần di chuyển trong sự đồng điệu tuyệt đối, tiếng hát ca tụng của họ vang vọng hài hòa. Đôi cánh vàng óng, rộng lớn của Lucifer lấp lánh một thứ hào quang siêu thực, dường như hút lấy mọi ánh sáng của Thiên Đàng. Nhưng chúng khẽ cựa quậy, ẩn chứa một nỗi bất an mơ hồ. Ánh mắt y không rời khỏi đường chân trời xa xăm, nơi một tia sáng yếu ớt, mong manh của một thực thể mới lạ đang treo lơ lửng trên tấm thảm sao trời. Trái Đất. Một thế giới của sự không hoàn hảo, của sự thay đổi. Một ý nghĩ thoáng qua: Liệu sự không hoàn hảo có phải là cái giá của ý nghĩa?</p>
                <p>Tâm trí Lucifer là một cơn bão dữ dội ẩn sau vẻ ngoài điềm tĩnh. Đã có lúc, y tìm thấy niềm vui trong những bài ca bất tận của Thiên Đàng. Nhưng thời gian vô tình trôi đi, hàng thế kỷ nối tiếp hàng thế kỷ, giai điệu ấy dần trở nên sáo rỗng, ý nghĩa của nó phai nhạt như tiếng vọng trong một đại sảnh hoang vu. Y tự hỏi, đó có thực sự là niềm vui, hay chỉ là sự phục tùng khoác lên mình chiếc áo choàng của sự hài hòa?</p>
                <h4>Cảnh Báo Của Michael</h4>
                <p>"Lucifer," một giọng nói trầm ấm, kiên định vang lên, phá tan dòng suy nghĩ của y.</p>
                <p>Lucifer chậm rãi quay người, đôi cánh vàng óng khép lại sau lưng. Y nhận ra giọng nói quen thuộc – đó là Michael. Khoác trên mình bộ giáp bạc sáng loáng dưới ánh sáng vĩnh cửu, Michael bước tới. Gương mặt y cương nghị, không chút lay chuyển, nhưng đâu đó vẫn ẩn chứa sự ấm áp dành cho người anh em.</p>
                <p>"Ngươi đã đứng đây quá lâu rồi," Michael nói. "Sao không hòa mình vào bài ca cùng các anh em khác?"</p>
                <p>Giọng Lucifer, khi cuối cùng cất lên, thật nhẹ nhàng nhưng lại sắc như dao cạo. "Ngươi chưa từng tự hỏi sao, Michael? Tại sao chúng ta phải hát? Mục đích là gì?"</p>
                <p>Michael khựng lại một thoáng, một nét khó xử thoáng qua gương mặt trước khi bị thay thế bởi sự cương quyết thường thấy. "Mục đích là phụng sự Đấng Sáng Tạo, Lucifer. Đó là vinh dự cao quý nhất."</p>
                <p>"Vinh dự," Lucifer lặp lại, một nụ cười nhạt thoáng trên môi. "Hay chỉ là thói quen?"</p>
                <p>(Còn tiếp...)</p>
            </div>
            </div>
        </div>
        
 
        <div class="navigation flex flex-col sm:flex-row justify-between items-center mt-10 mb-6 space-y-4 sm:space-y-0">
            <button id="list-chapter-btn" class="w-full sm:w-auto px-6 py-3 rounded-lg font-semibold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center">
                <i class="fas fa-list-ul mr-2"></i>Danh sách Chương
            </button>
            <button id="prev-chapter-btn" class="w-full sm:w-auto px-6 py-3 rounded-lg font-semibold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center" disabled>
                <i class="fas fa-arrow-left mr-2"></i>Chương Trước
            </button>
            <button id="next-chapter-btn" class="w-full sm:w-auto px-6 py-3 rounded-lg font-semibold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center">
                Chương Tiếp<i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </main>

    <div id="chapter-modal" class="modal fixed inset-0 bg-black bg-opacity-60 dark:bg-opacity-75 flex items-center justify-center p-4 transition-opacity duration-300 ease-in-out opacity-0 pointer-events-none" style="/* display: none; được JS quản lý bằng class modal-active */">
        <div class="modal-content bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-lg shadow-2xl w-full max-w-md relative transform transition-all duration-300 ease-in-out scale-95 opacity-0">
            <span id="close-modal-btn" class="close absolute top-3 right-4 text-gray-500 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 text-3xl cursor-pointer transition-colors leading-none">&times;</span>
            <h3 class="text-2xl font-semibold mb-6 text-gray-800 dark:text-white">Danh Sách Các Chương</h3>
            <ul id="modal-chapter-list" class="space-y-1 max-h-80 sm:max-h-96 overflow-y-auto pr-2">
                <li><a href="#chapter-1" data-chapter-id="chapter-1" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 1: Bản Hòa Âm Vĩnh Cửu</a></li>
                <li><a href="#chapter-2" data-chapter-id="chapter-2" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 2: Lời Phán Từ Trời</a></li>
                <li><a href="#chapter-3" data-chapter-id="chapter-3" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 3: Những Tia Lửa Nổi Loạn</a></li>
                <li><a href="#chapter-4" data-chapter-id="chapter-4" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 4: Những Tạo Vật Đầu Tiên</a></li>
                <li><a href="#chapter-5" data-chapter-id="chapter-5" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 5: Ánh Sáng Và Bóng Tối</a></li>
                <li><a href="#chapter-6" data-chapter-id="chapter-6" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 6: Lời Thì Thầm Của Con Rắn</a></li>
                <li><a href="#chapter-7" data-chapter-id="chapter-7" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 7: Sự Rạn Nứt</a></li>
                <li><a href="#chapter-8" data-chapter-id="chapter-8" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 8: Sự Ra Đời Của Eve</a></li>
                <li><a href="#chapter-9" data-chapter-id="chapter-9" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 9: Những Bóng Tối Thì Thầm</a></li>
                <li><a href="#chapter-10" data-chapter-id="chapter-10" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 10: Hạt Giống Của Sự Phá Hủy</a></li>
                <li><a href="#chapter-11" data-chapter-id="chapter-11" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 11: Sự Sa Ngã</a></li>
                <li><a href="#chapter-12" data-chapter-id="chapter-12" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 12: Sự Ra Đời Đầu Tiên</a></li>
                <li><a href="#chapter-13" data-chapter-id="chapter-13" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 13: Vết Nứt Đầu Tiên</a></li>
                <li><a href="#chapter-14" data-chapter-id="chapter-14" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 14: Dấu Ấn Của Cain</a></li>
                <li><a href="#chapter-15" data-chapter-id="chapter-15" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 15: Di Sản Của Cain</a></li>
                <li><a href="#chapter-16" data-chapter-id="chapter-16" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 16: Sự Phán Xét Đầu Tiên</a></li>
                <li><a href="#chapter-17" data-chapter-id="chapter-17" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 17: Cửa Lũ Mở Toang</a></li>
                <li><a href="#chapter-18" data-chapter-id="chapter-18" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 18: Cuộc Chiến Ánh Sáng Vĩnh Cửu</a></li>
                <li><a href="#chapter-19" data-chapter-id="chapter-19" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 19: Những Hạt Giống Của Sự Nổi Loạn</a></li>
                <li><a href="#chapter-20" data-chapter-id="chapter-20" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 20: Dư Âm của Những Lựa Chọn</a></li>
                <li><a href="#chapter-21" data-chapter-id="chapter-21" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 21: Sự Vỡ Nát của Tấm Màn</a></li>
                <li><a href="#chapter-22" data-chapter-id="chapter-22" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 22: Bên Kia Tấm Màn</a></li>
                <li><a href="#chapter-23" data-chapter-id="chapter-23" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 23: Sự Thật Bên Kia Tấm Màn</a></li>
                <li><a href="#chapter-24" data-chapter-id="chapter-24" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 24: Cái Giá của Ánh Sáng</a></li>
                <li><a href="#chapter-25" data-chapter-id="chapter-25" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 25: Phán Quyết và Sự Chia Cắt Vĩnh Viễn</a></li>
                <li><a href="#chapter-26" data-chapter-id="chapter-26" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 26: Bình Minh Cuối Cùng</a></li>
                <li><a href="#chapter-27" data-chapter-id="chapter-27" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 27: Ranh Giới Vĩnh Hằng</a></li>
                <li><a href="#chapter-28" data-chapter-id="chapter-28" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Chương 28: Ngã Tư Đường Vĩnh Cửu</a></li>
                <li><a href="#epilogue" data-chapter-id="epilogue" class="modal-chapter-link block p-3 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Khúc Vĩ Thanh: Mưa Sao Băng Linh Hồn</a></li>
            </ul>
        </div>
    </div>

    <footer id="footer" class="bg-gray-100 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 transition-colors duration-300 ease-in-out">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center">
            <div class="footer-links mb-6 space-x-2 sm:space-x-4">        
                <a href="legnaxe_part1_en.html" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 text-sm sm:text-base transition-colors">English Version</a>
                <a href="author-about.html" class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 text-sm sm:text-base transition-colors">Về Tác Giả</a>
            </div>
            <p class="text-sm text-gray-500 dark:text-gray-400">© <span id="current-year">2025</span> LEGNAXE. All rights reserved. Author:NMT</p>
            <p class="text-xs text-gray-400 dark:text-gray-500 mt-2">Một sản phẩm của IVS JSC. Website: <a href="https://ivs.id.vn" target="_blank" rel="noopener noreferrer" class="hover:underline">ivs.id.vn</a></p>
        </div>
    </footer>

    <div class="fixed bottom-6 right-6 z-50 flex flex-col items-end space-y-3">
        <a href="https://zalo.me/ivsjsc" target="_blank" rel="noopener noreferrer"
           class="flex items-center justify-center w-12 h-12 rounded-full bg-blue-500 text-white shadow-lg hover:bg-blue-600 transition-colors duration-200"
           aria-label="Chat on Zalo OA">
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 50 50" fill="currentColor">
                 <path d="M 9 4 C 6.2504839 4 4 6.2504839 4 9 L 4 41 C 4 43.749516 6.2504839 46 9 46 L 41 46 C 43.749516 46 46 43.749516 46 41 L 46 9 C 46 6.2504839 43.749516 4 41 4 L 9 4 z M 9 6 L 15.580078 6 C 12.00899 9.7156859 10 14.518083 10 19.5 C 10 24.66 12.110156 29.599844 15.910156 33.339844 C 16.030156 33.549844 16.129922 34.579531 15.669922 35.769531 C 15.379922 36.519531 14.799687 37.499141 13.679688 37.869141 C 13.249688 38.009141 12.97 38.430859 13 38.880859 C 13.03 39.330859 13.360781 39.710781 13.800781 39.800781 C 16.670781 40.370781 18.529297 39.510078 20.029297 38.830078 C 21.379297 38.210078 22.270625 37.789609 23.640625 38.349609 C 26.440625 39.439609 29.42 40 32.5 40 C 36.593685 40 40.531459 39.000731 44 37.113281 L 44 41 C 44 42.668484 42.668484 44 41 44 L 9 44 C 7.3315161 44 6 42.668484 6 41 L 6 9 C 6 7.3315161 7.3315161 6 9 6 z M 33 15 C 33.55 15 34 15.45 34 16 L 34 25 C 34 25.55 33.55 26 33 26 C 32.45 26 32 25.55 32 25 L 32 16 C 32 15.45 32.45 15 33 15 z M 18 16 L 23 16 C 23.36 16 23.700859 16.199531 23.880859 16.519531 C 24.050859 16.829531 24.039609 17.219297 23.849609 17.529297 L 19.800781 24 L 23 24 C 23.55 24 24 24.45 24 25 C 24 25.55 23.55 26 23 26 L 18 26 C 17.64 26 17.299141 25.800469 17.119141 25.480469 C 16.949141 25.170469 16.960391 24.780703 17.150391 24.470703 L 21.199219 18 L 18 18 C 17.45 18 17 17.55 17 17 C 17 16.45 17.45 16 18 16 z M 27.5 19 C 28.11 19 28.679453 19.169219 29.189453 19.449219 C 29.369453 19.189219 29.65 19 30 19 C 30.55 19 31 19.45 31 20 L 31 25 C 31 25.55 30.55 26 30 26 C 29.65 26 29.369453 25.810781 29.189453 25.550781 C 28.679453 25.830781 28.11 26 27.5 26 C 25.57 26 24 24.43 24 22.5 C 24 20.57 25.57 19 27.5 19 z M 38.5 19 C 40.43 19 42 20.57 42 22.5 C 42 24.43 40.43 26 38.5 26 C 36.57 26 35 24.43 35 22.5 C 35 20.57 36.57 19 38.5 19 z M 27.5 21 C 27.39625 21 27.29502 21.011309 27.197266 21.03125 C 27.001758 21.071133 26.819727 21.148164 26.660156 21.255859 C 26.500586 21.363555 26.363555 21.500586 26.255859 21.660156 C 26.148164 21.819727 26.071133 22.001758 26.03125 22.197266 C 26.011309 22.29502 26 22.39625 26 22.5 C 26 22.60375 26.011309 22.70498 26.03125 22.802734 C 26.051191 22.900488 26.079297 22.994219 26.117188 23.083984 C 26.155078 23.17375 26.202012 23.260059 26.255859 23.339844 C 26.309707 23.419629 26.371641 23.492734 26.439453 23.560547 C 26.507266 23.628359 26.580371 23.690293 26.660156 23.744141 C 26.819727 23.851836 27.001758 23.928867 27.197266 23.96875 C 27.29502 23.988691 27.39625 24 27.5 24 C 27.60375 24 27.70498 23.988691 27.802734 23.96875 C 28.487012 23.82916 29 23.22625 29 22.5 C 29 21.67 28.33 21 27.5 21 z M 38.5 21 C 38.39625 21 38.29502 21.011309 38.197266 21.03125 C 38.099512 21.051191 38.005781 21.079297 37.916016 21.117188 C 37.82625 21.155078 37.739941 21.202012 37.660156 21.255859 C 37.580371 21.309707 37.507266 21.371641 37.439453 21.439453 C 37.303828 21.575078 37.192969 21.736484 37.117188 21.916016 C 37.079297 22.005781 37.051191 22.099512 37.03125 22.197266 C 37.011309 22.29502 37 22.39625 37 22.5 C 37 22.60375 37.011309 22.70498 37.03125 22.802734 C 37.051191 22.900488 37.079297 22.994219 37.117188 23.083984 C 37.155078 23.17375 37.202012 23.260059 37.255859 23.339844 C 37.309707 23.419629 37.371641 23.492734 37.439453 23.560547 C 37.507266 23.628359 37.580371 23.690293 37.660156 23.744141 C 37.739941 23.797988 37.82625 23.844922 37.916016 23.882812 C 38.005781 23.920703 38.099512 23.948809 38.197266 23.96875 C 38.29502 23.988691 38.39625 24 38.5 24 C 38.60375 24 38.70498 23.988691 38.802734 23.96875 C 39.487012 23.82916 40 23.22625 40 22.5 C 40 21.67 39.33 21 38.5 21 z"></path>
            </svg>
        </a>     
        <button id="scrollToTopBtn"
                class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-700 text-white shadow-lg hover:bg-gray-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900"
                aria-label="Scroll to top">
            <i class="fas fa-arrow-up text-xl" aria-hidden="true"></i>
        </button>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const chapters = Array.from(document.querySelectorAll('.chapter'));
        let currentChapterIndex = 0;

        const prevButton = document.getElementById('prev-chapter-btn');
        const nextButton = document.getElementById('next-chapter-btn');
        const listChapterButton = document.getElementById('list-chapter-btn'); 

        const chapterModal = document.getElementById('chapter-modal');
        const closeModalButton = document.getElementById('close-modal-btn'); 
        const modalChapterLinks = document.querySelectorAll('.modal-chapter-link');

        const themeToggle = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement; 
        const bodyElement = document.body; 
        const themeIcon = themeToggle ? themeToggle.querySelector('i') : null;
        const currentYearSpan = document.getElementById('current-year');

        function showChapter(index, isInitialLoad = false) {
            if (index < 0 || index >= chapters.length) {
                console.warn("Chỉ số chương không hợp lệ:", index);
                return;
            }

            chapters.forEach((chapter, i) => {
                chapter.classList.toggle('active', i === index);
            });

            if (prevButton) prevButton.disabled = index === 0;
            if (nextButton) nextButton.disabled = index === chapters.length - 1;

            currentChapterIndex = index;

            if (!isInitialLoad) {
                const storyContentWrapper = document.querySelector('.story-content-wrapper');
                if (storyContentWrapper) {
                    const navbarHeight = document.getElementById('navbar')?.offsetHeight || 0;
                    window.scrollTo({
                        top: storyContentWrapper.offsetTop - navbarHeight - 20,
                        behavior: 'smooth'
                    });
                } else {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }

            if (chapters[currentChapterIndex] && !isInitialLoad) {
                // Cập nhật hash mà không gây nhảy trang nếu đã ở đúng vị trí
                if (window.location.hash !== `#${chapters[currentChapterIndex].id}`) {
                     history.pushState(null, null, `#${chapters[currentChapterIndex].id}`);
                }
            }
        }
        
        function showChapterFromHash(isInitialLoad = false) {
            const hash = window.location.hash.substring(1); 
            if (hash) {
                const targetIndex = chapters.findIndex(chap => chap.id === hash);
                if (targetIndex !== -1) {
                    showChapter(targetIndex, isInitialLoad);
                    if (isInitialLoad) {
                        setTimeout(() => { 
                            const targetElement = document.getElementById(hash);
                            if(targetElement) {
                                const navbarHeight = document.getElementById('navbar')?.offsetHeight || 0;
                                // Sử dụng getBoundingClientRect().top + window.pageYOffset để lấy vị trí chính xác
                                const elementTop = targetElement.getBoundingClientRect().top + window.pageYOffset;
                                window.scrollTo({
                                    top: elementTop - navbarHeight - 20, 
                                    behavior: 'auto' 
                                });
                            }
                        }, 50); // Delay nhỏ để DOM render xong xuôi
                    }
                    return true; 
                }
            }
            return false; 
        }

        if (prevButton) {
            prevButton.addEventListener('click', () => {
                if (currentChapterIndex > 0) {
                    showChapter(currentChapterIndex - 1);
                }
            });
        }

        if (nextButton) {
            nextButton.addEventListener('click', () => {
                if (currentChapterIndex < chapters.length - 1) {
                    showChapter(currentChapterIndex + 1);
                }
            });
        }

        if (listChapterButton && chapterModal) {
            listChapterButton.addEventListener('click', () => {
                chapterModal.style.display = 'flex';
                setTimeout(() => { 
                    chapterModal.classList.add('modal-active');
                }, 10); 
                bodyElement.style.overflow = 'hidden'; 
            });
        }

        function closeModal() {
            if (chapterModal) {
                chapterModal.classList.remove('modal-active');
                setTimeout(() => {
                    if (!chapterModal.classList.contains('modal-active')) {
                         chapterModal.style.display = 'none';
                    }
                }, 300); 
                bodyElement.style.overflow = ''; 
            }
        }

        if (closeModalButton) {
            closeModalButton.addEventListener('click', closeModal);
        }

        if (chapterModal) { 
            chapterModal.addEventListener('click', (event) => {
                if (event.target === chapterModal) {
                    closeModal();
                }
            });
        }

        modalChapterLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const chapterId = link.getAttribute('href')?.substring(1) || link.dataset.chapterId;
                if (!chapterId) return;

                const targetIndex = chapters.findIndex(chap => chap.id === chapterId);
                if (targetIndex !== -1) {
                    showChapter(targetIndex);
                }
                closeModal();
            });
        });

        function applyTheme(isDark) {
            htmlElement.classList.toggle('dark', isDark);
            if (themeIcon) {
                themeIcon.classList.toggle('fa-moon', !isDark);
                themeIcon.classList.toggle('fa-sun', isDark);
            }
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const savedTheme = localStorage.getItem('theme');
        let currentIsDarkMode = savedTheme === 'dark' || (savedTheme === null && prefersDarkScheme);
        
        applyTheme(currentIsDarkMode); 

        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                currentIsDarkMode = !htmlElement.classList.contains('dark');
                applyTheme(currentIsDarkMode);
            });
        }

        if (chapters.length > 0) {
            if (!showChapterFromHash(true)) { 
                showChapter(0, true); 
            }
        } else { 
            if (prevButton) prevButton.disabled = true;
            if (nextButton) nextButton.disabled = true;
            if (listChapterButton) listChapterButton.disabled = true;
        }
        
        if (currentYearSpan) {
            currentYearSpan.textContent = new Date().getFullYear();
        }

        window.addEventListener('hashchange', () => showChapterFromHash(false));

    });
    </script>
</body>
</html>