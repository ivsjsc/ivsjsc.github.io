<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chọn Truyện Để Đọc - IVS</title>
    <meta name="description" content="Danh sách truyện hấp dẫn từ IVS: LEGNAXE - Bí mật cuộc chiến Thiên Đàng.">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {}
                }
            },
            darkMode: 'class'
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --header-height-initial: 80px;
            --header-height-scrolled: 60px;
            --header-height-mobile: 60px;
        }

        body {
            padding-top: var(--header-height-mobile);
            font-family: 'Inter', sans-serif;
        }

        @media (min-width: 1024px) {
            body { padding-top: var(--header-height-initial); }
        }

        html.dark body { @apply bg-gray-900 text-gray-300; }
        html.dark .page-content-container { @apply bg-gray-800; }
        html.dark h1.page-title { @apply text-sky-400; }
        html.dark .novel-card { @apply bg-gray-700 border-gray-600; }
        html.dark .novel-card h3 { @apply text-gray-100; }
        html.dark .novel-card p { @apply text-gray-300; }
        html.dark .novel-card a.read-button:not([aria-disabled='true']) {
            @apply bg-gradient-to-r from-sky-600 to-blue-600 hover:from-sky-700 hover:to-blue-700;
        }
        html.dark .novel-card a.read-button.english-button:not([aria-disabled='true']) {
             @apply !bg-gradient-to-r !from-emerald-600 !to-green-600 !hover:from-emerald-700 !to-green-700;
        }
        html.dark .settings button {
            @apply bg-gradient-to-r from-pink-600 to-red-600 hover:from-pink-700 hover:to-red-700;
        }
        html.dark .novel-card a.read-button[aria-disabled='true'] {
             @apply !bg-gradient-to-r !from-gray-600 !to-gray-700 !text-gray-400;
        }

        #header-placeholder {
            min-height: var(--header-height-mobile);
        }
        @media (min-width: 1024px) {
             #header-placeholder { min-height: var(--header-height-initial); }
        }

        .page-content-container {
            @apply mt-6 mb-8 p-4 sm:p-6 lg:p-8 bg-white rounded-xl shadow-lg;
        }

        h1.page-title {
            @apply text-center text-3xl sm:text-4xl font-bold text-gray-800 mt-4 mb-8 tracking-tight;
        }

        .novel-list {
            @apply grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6 sm:gap-8;
        }

        .novel-card {
            @apply bg-white rounded-lg overflow-hidden shadow-md border border-gray-200 flex flex-col transition-all duration-300 hover:shadow-xl hover:-translate-y-1;
        }

        .novel-card .cover-link {
            @apply block overflow-hidden relative aspect-[2/3];
        }

        .novel-card img.book-cover {
            @apply w-full h-full object-cover transition-transform duration-300 group-hover:scale-105;
        }

        .novel-card .card-content {
            @apply p-4 sm:p-5 flex flex-col flex-grow bg-gray-50 dark:bg-gray-700;
        }

        .novel-card h3 {
            @apply text-lg sm:text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 leading-tight line-clamp-2 tracking-tight;
        }

        .novel-card p {
            @apply text-sm text-gray-600 dark:text-gray-300 mb-4 flex-grow line-clamp-3 leading-relaxed;
        }

        .novel-card a.read-button {
            @apply block w-full text-center py-3 px-4 bg-gradient-to-r from-blue-600 to-sky-600 text-white rounded-lg text-sm sm:text-base font-semibold shadow-md hover:from-blue-700 hover:to-sky-700 hover:shadow-lg min-h-[48px] transition-all duration-300 touch-action-manipulation mt-auto flex items-center justify-center gap-2;
        }
        .novel-card a.read-button.english-button {
             @apply !bg-gradient-to-r !from-emerald-500 !to-green-500 !hover:from-emerald-600 !to-green-600;
        }

        .novel-card a.read-button[aria-disabled='true'] {
            @apply !bg-gradient-to-r !from-gray-400 !to-gray-500 !text-gray-200 !cursor-not-allowed !hover:from-gray-400 !hover:to-gray-500 !shadow-none;
        }

        .settings {
            @apply fixed bottom-4 right-4 z-50;
        }

        .settings button {
            @apply py-2 px-5 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-full text-sm font-medium shadow hover:shadow-md transition-all duration-300 touch-action-manipulation;
        }

        #footer-placeholder {
        }

        .fetch-error-message {
             @apply text-sm p-3 rounded-md border;
        }
        .fetch-error-message.header-error {
             @apply fixed top-0 left-0 right-0 z-50 bg-red-100 border-red-300 text-red-800;
             min-height: var(--header-height-mobile);
             @apply flex items-center justify-center text-center;
        }
         @media (min-width: 1024px) {
             .fetch-error-message.header-error { min-height: var(--header-height-initial); }
         }
        .fetch-error-message.footer-error {
             @apply bg-red-100 border-red-300 text-red-800 text-center;
        }
        html.dark .fetch-error-message {
            @apply bg-red-900/50 border-red-700 text-red-200;
        }

    </style>
</head>
<body class="antialiased">

    <header id="header-placeholder">
        <div class="fixed top-0 left-0 right-0 z-50 flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 animate-pulse" style="height: var(--header-height-mobile);">
             Đang tải header...
        </div>
    </header>

    <div class="main-content-wrapper flex-grow">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="page-content-container">
                <h1 class="page-title">Chọn Truyện Để Đọc</h1>

                <div class="settings">
                    <button onclick="toggleDarkMode()" aria-label="Chuyển chế độ Sáng/Tối">
                        <i class="fas fa-adjust mr-1"></i>
                        <span class="hidden sm:inline">Sáng/Tối</span>
                    </button>
                </div>

                <div class="novel-list">

                    <div class="novel-card group">
                        <a href="legnaxe_part1_vi.html" class="cover-link" aria-label="Đọc LEGNAXE Phần 1 Tiếng Việt">
                            <picture>
                                <source srcset="images/pages/novels/legnaxe1.webp" type="image/webp">
                                <img src="images/pages/novels/legnaxe1.png" alt="[Image of Bìa LEGNAXE Phần 1]" class="book-cover" loading="lazy" onerror="this.onerror=null; this.src='https://placehold.co/400x600/EBF4FF/4A5568?text=LEGNAXE+P1';">
                            </picture>
                        </a>
                        <div class="card-content">
                            <h3 class="!line-clamp-1">LEGNAXE: Phần 1</h3>
                            <p class="mb-4">Bí mật cuộc đại chiến Thiên Đàng / Secrets of Heaven's Great War.</p>
                            <div class="flex flex-col sm:flex-row gap-3 mt-auto">
                                <a href="legnaxe_part1_vi.html" class="read-button">
                                    <i class="fas fa-book-open"></i> Đọc (TV)
                                </a>
                                <a href="legnaxe_part1_en.html" class="read-button english-button">
                                    <i class="fas fa-book-open"></i> Read (EN)
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="novel-card group">
                         <a href="legnaxe_part2_vi.html" class="cover-link" aria-label="Đọc LEGNAXE Phần 2 Tiếng Việt">
                             <picture>
                                 <source srcset="images/pages/novels/legnaxe2.webp" type="image/webp">
                                 <img src="images/pages/novels/legnaxe2.png" alt="" class="book-cover" loading="lazy" onerror="this.onerror=null; this.src='https://placehold.co/400x600/FFF5F5/7F1D1D?text=LEGNAXE+P2';">
                             </picture>
                         </a>
                         <div class="card-content">
                             <h3 class="!line-clamp-1">LEGNAXE: Phần 2</h3>
                             <p class="mb-4">Hành trình Trần Gian & Trái tim con người / Heavenly, Human’s Heart.</p>
                             <div class="flex flex-col sm:flex-row gap-3 mt-auto">
                                 <a href="legnaxe_part2_vi.html" class="read-button">
                                     <i class="fas fa-book-open"></i> Đọc (TV)
                                 </a>
                                 <a href="#" class="read-button" aria-disabled="true" >
                                     <i class="fas fa-clock mr-1"></i> Read (EN - Soon)
                                 </a>
                             </div>
                         </div>
                    </div>

                    <div class="novel-card group opacity-50"> <a href="#" class="cover-link cursor-default" aria-label="Truyện sắp ra mắt">
                             <picture>
                                 <source srcset="https://placehold.co/400x600/F3E8FF/6B46C1?text=Coming+Soon.webp" type="image/webp">
                                 <img src="https://placehold.co/400x600/F3E8FF/6B46C1?text=Coming+Soon" alt="[Image of Bìa truyện sắp ra mắt]" class="book-cover" loading="lazy" onerror="this.onerror=null; this.src='https://placehold.co/400x600/eee/aaa?text=Image+Error';">
                             </picture>
                         </a>
                         <div class="card-content">
                             <h3 class="!line-clamp-1">Truyện Mới</h3>
                             <p class="mb-4">Một cuộc phiêu lưu kỳ thú khác sắp bắt đầu...</p>
                             <div class="flex flex-col sm:flex-row gap-3 mt-auto">
                                 <a href="#" class="read-button" aria-disabled="true">
                                     <i class="fas fa-clock"></i> Sắp ra mắt
                                 </a>
                                  <a href="#" class="read-button english-button" aria-disabled="true">
                                     <i class="fas fa-clock"></i> Coming Soon
                                 </a>
                             </div>
                         </div>
                     </div>

                </div> </div> </div> </div> <footer id="footer-placeholder">
        <div class="bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 text-center p-4 animate-pulse">
            Đang tải footer...
        </div>
    </footer>

    <script>
        function toggleDarkMode() {
            const isDarkMode = document.documentElement.classList.toggle("dark");
            localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');
        }

        if (localStorage.getItem('darkMode') === 'enabled' || (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add("dark");
        } else {
             document.documentElement.classList.remove("dark");
        }

        document.addEventListener('DOMContentLoaded', function() {
            const headerPlaceholder = document.getElementById('header-placeholder');
            const footerPlaceholder = document.getElementById('footer-placeholder');
            const headerPath = '_header.html';
            const footerPath = '_footer.html';

            function handleFetchError(error, placeholderElement, type) {
                let errorMessage = `<i class="fas fa-exclamation-triangle mr-2"></i> Lỗi tải ${type}.`;
                let errorDetails = ` (${error.message})`;

                if (error instanceof TypeError && error.message.includes('Failed to parse URL') || error.message.includes('Failed to fetch')) {
                     if(window.location.protocol === 'file:') {
                         errorMessage = `<i class="fas fa-exclamation-circle mr-2"></i> <strong>Không thể tải ${type} trực tiếp từ file.</strong><br>Vui lòng chạy trang web này qua một máy chủ cục bộ (local server) để tính năng fetch hoạt động.`;
                         errorDetails = "";
                     } else {
                          errorMessage = `<i class="fas fa-exclamation-triangle mr-2"></i> Lỗi mạng khi tải ${type}. Vui lòng kiểm tra kết nối và Console (F12).`;
                     }

                } else if (error.message.includes('HTTP error')) {
                     errorMessage = `<i class="fas fa-exclamation-triangle mr-2"></i> Lỗi tải ${type}. Không tìm thấy file hoặc lỗi máy chủ. Vui lòng kiểm tra đường dẫn file và Console (F12).`;
                } else {
                     errorMessage = `<i class="fas fa-exclamation-triangle mr-2"></i> Lỗi không xác định khi tải ${type}. Vui lòng kiểm tra Console (F12).`;
                }

                placeholderElement.innerHTML = `<div class="fetch-error-message ${type}-error">${errorMessage}${errorDetails}</div>`;
            }

            if (headerPlaceholder) {
                fetch(headerPath)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error fetching header! Status: ${response.status} ${response.statusText}`);
                        }
                        return response.text();
                    })
                    .then(data => {
                        headerPlaceholder.innerHTML = data;
                        initializeHeaderScriptsIfNeeded();
                    })
                    .catch(error => {
                        handleFetchError(error, headerPlaceholder, 'header');
                    });
            }

            if (footerPlaceholder) {
                fetch(footerPath)
                    .then(response => {
                        if (!response.ok) {
                             throw new Error(`HTTP error fetching footer! Status: ${response.status} ${response.statusText}`);
                         }
                        return response.text();
                     })
                    .then(data => {
                        footerPlaceholder.innerHTML = data;
                        initializeFooterScriptsIfNeeded();
                     })
                    .catch(error => {
                         handleFetchError(error, footerPlaceholder, 'footer');
                     });
            }

        });

        function initializeHeaderScriptsIfNeeded() {
            try {
                 const mobileMenuButton = document.getElementById('mobile-menu-button');
                 if (mobileMenuButton) {
                 }
             } catch (e) {
             }
        }

        function initializeFooterScriptsIfNeeded() {
             try {
                const footerElement = document.getElementById('footer-placeholder');
                if (footerElement) {
                    const currentYearSpan = footerElement.querySelector('#current-year');
                    if (currentYearSpan) {
                        currentYearSpan.textContent = new Date().getFullYear();
                    }
                }
             } catch (e) {
             }
        }

    </script>

</body>
</html>