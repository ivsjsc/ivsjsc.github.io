// JSON data for featured posts
const posts = [
    {
      title: "TRáº I HÃˆ QUá»C Táº¾ Táº I PHILIPPINES 2025",
      excerpt: "ðŸŽ‰Tin vui cho cÃ¡c báº­c phá»¥ huynh vÃ  cÃ¡c em há»c sinh! IVS Academy thÃ´ng bÃ¡o vá» chÆ°Æ¡ng trÃ¬nh Há»c bá»•ng Tráº¡i hÃ¨ Quá»‘c táº¿...",
      url: "summercamp.html",
      image: "images/summerbanner.jpg",
    },
    {
      title: "TÆ¯ Váº¤N THá»¦ Tá»¤C THÃ€NH Láº¬P TRUNG TÃ‚M, CÆ  Sá»ž GIÃO Dá»¤C",
      excerpt: "ðŸŽ‰TÆ° váº¥n, há»— trá»£ thá»§ tá»¥c, há»“ sÆ¡ phÃ¡p lÃ½, tÃ i liá»‡u, chÆ°Æ¡ng trÃ¬nh Ä‘Ã o táº¡o, tá»« A tá»›i Z.",
      url: "tuvan.html",
      image: "images/lifeminds.png",
    },
    {
      title: "Há»¢P TÃC Äáº¦U TÆ¯",
      excerpt: "ðŸŽ‰CÆ¡ há»™i bá»©c phÃ¡ cÃ¹ng ngÃ nh giÃ¡o dá»¥c, má»™t tÆ°Æ¡ng lai bá»n vá»¯ng",
      url: "hop-tac-dau-tu.html",
      image: "images/ivs-celestech.jpg",
    },
    {
      title: "TUYá»‚N Dá»¤NG",
      excerpt: "ðŸŽ‰Tin tuyá»ƒn dá»¥ng tá»« IVS JSC",
      url: "career.html",
      image: "images/logo.png",
    },
  ];
  
  // Function to render posts dynamically
  function renderPosts() {
    const postList = document.getElementById("post-list");
    if (!postList) {
      console.error("Error: #post-list element not found in the DOM.");
      return;
    }
  
    // Clear existing content
    postList.innerHTML = "";
  
    // Render each post
    posts.forEach((post, index) => {
      const postElement = document.createElement("div");
      postElement.classList.add("post-preview");
      postElement.setAttribute("role", "article"); // Accessibility: Define as an article
      postElement.setAttribute("aria-labelledby", `post-title-${index}`); // Link to the title for screen readers
  
      postElement.innerHTML = `
        <div class="post-image">
          <img src="${post.image}" alt="${post.title}" loading="lazy">
          ${index === 0 ? '<span class="hot-label">HOT</span>' : ""}
        </div>
        <div class="content">
          <h3 id="post-title-${index}">${post.title}</h3>
          <p>${post.excerpt}</p>
          <a href="${post.url}" class="view-more" aria-label="Xem thÃªm vá» ${post.title}">Xem thÃªm</a>
        </div>
      `;
  
      postList.appendChild(postElement);
    });
  }
  
  // Function to initialize the carousel
  function initializeCarousel() {
    const postList = document.getElementById("post-list");
    const prevButton = document.getElementById("prev-post");
    const nextButton = document.getElementById("next-post");
  
    // Error handling: Check if elements exist
    if (!postList || !prevButton || !nextButton) {
      console.error("Error: Required carousel elements not found in the DOM.");
      return;
    }
  
    let currentIndex = 0;
    const postsPerPage = 3; // Number of posts to show at a time on desktop
    const totalPosts = posts.length;
  
    // Function to update the carousel position
    function updateCarousel() {
      const offset = currentIndex * (100 / postsPerPage);
      postList.style.transform = `translateX(-${offset}%)`;
      postList.style.transition = "transform 0.5s ease-in-out"; // Smooth transition
  
      // Update button states
      prevButton.disabled = currentIndex === 0;
      nextButton.disabled = currentIndex >= totalPosts - postsPerPage;
  
      // Accessibility: Update ARIA attributes
      prevButton.setAttribute("aria-disabled", currentIndex === 0 ? "true" : "false");
      nextButton.setAttribute("aria-disabled", currentIndex >= totalPosts - postsPerPage ? "true" : "false");
    }
  
    // Event listeners for navigation buttons
    prevButton.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        updateCarousel();
      }
    });
  
    nextButton.addEventListener("click", () => {
      if (currentIndex < totalPosts - postsPerPage) {
        currentIndex++;
        updateCarousel();
      }
    });
  
    // Keyboard navigation for accessibility
    prevButton.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        if (currentIndex > 0) {
          currentIndex--;
          updateCarousel();
        }
      }
    });
  
    nextButton.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        if (currentIndex < totalPosts - postsPerPage) {
          currentIndex++;
          updateCarousel();
        }
      }
    });
  
    // Initial update
    updateCarousel();
  
    // Disable carousel on mobile (max-width: 600px)
    const mediaQuery = window.matchMedia("(max-width: 600px)");
    function handleMediaChange(e) {
      if (e.matches) {
        // On mobile, reset transform and transition for horizontal scrolling
        postList.style.transform = "translateX(0)";
        postList.style.transition = "none";
        prevButton.disabled = true;
        nextButton.disabled = true;
      } else {
        // On desktop, re-enable carousel
        updateCarousel();
      }
    }
  
    // Initial check