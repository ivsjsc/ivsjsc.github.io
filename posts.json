// JSON data for featured posts
const posts = [
    {
      title: "TR·∫†I H√à QU·ªêC T·∫æ T·∫†I PHILIPPINES 2025",
      excerpt: "üéâTin vui cho c√°c b·∫≠c ph·ª• huynh v√† c√°c em h·ªçc sinh! IVS Academy th√¥ng b√°o v·ªÅ ch∆∞∆°ng tr√¨nh H·ªçc b·ªïng Tr·∫°i h√® Qu·ªëc t·∫ø...",
      url: "summercamp.html",
      image: "images/summerbanner.jpg",
    },
    {
      title: "T∆Ø V·∫§N TH·ª¶ T·ª§C TH√ÄNH L·∫¨P TRUNG T√ÇM, C∆† S·ªû GI√ÅO D·ª§C",
      excerpt: "üéâT∆∞ v·∫•n, h·ªó tr·ª£ th·ªß t·ª•c, h·ªì s∆° ph√°p l√Ω, t√†i li·ªáu, ch∆∞∆°ng tr√¨nh ƒë√†o t·∫°o, t·ª´ A t·ªõi Z.",
      url: "tuvan.html",
      image: "images/lifeminds.png",
    },
    {
      title: "H·ª¢P T√ÅC ƒê·∫¶U T∆Ø",
      excerpt: "üéâC∆° h·ªôi b·ª©c ph√° c√πng ng√†nh gi√°o d·ª•c, m·ªôt t∆∞∆°ng lai b·ªÅn v·ªØng",
      url: "hop-tac-dau-tu.html",
      image: "images/ivs-celestech.jpg",
    },
    {
      title: "TUY·ªÇN D·ª§NG",
      excerpt: "üéâTin tuy·ªÉn d·ª•ng t·ª´ IVS JSC",
      url: "career.html",
      image: "images/logo.png",
    },
  ];
  
  // Function to render posts dynamically
  function renderPosts() {
    const postList = document.getElementById("post-list");
    if (!postList) {
      console.error("Error: #post-list element not found in the DOM.");
      return;
    }
  
    // Clear existing content
    postList.innerHTML = "";
  
    // Render each post
    posts.forEach((post, index) => {
      const postElement = document.createElement("div");
      postElement.classList.add("post-preview");
      postElement.setAttribute("role", "article"); // Accessibility: Define as an article
      postElement.setAttribute("aria-labelledby", `post-title-${index}`); // Link to the title for screen readers
  
      postElement.innerHTML = `
        <div class="post-image">
          <img src="${post.image}" alt="${post.title}" loading="lazy">
          ${index === 0 ? '<span class="hot-label">HOT</span>' : ""}
        </div>
        <div class="content">
          <h3 id="post-title-${index}">${post.title}</h3>
          <p>${post.excerpt}</p>
          <a href="${post.url}" class="view-more" aria-label="Xem th√™m v·ªÅ ${post.title}">Xem th√™m</a>
        </div>
      `;
  
      postList.appendChild(postElement);
    });
  }
  
  // Function to initialize the carousel
  function initializeCarousel() {
    const postList = document.getElementById("post-list");
    const prevButton = document.getElementById("prev-post");
    const nextButton = document.getElementById("next-post");
  
    // Error handling: Check if elements exist
    if (!postList || !prevButton || !nextButton) {
      console.error("Error: Required carousel elements not found in the DOM.");
      return;
    }
  
    let currentIndex = 0;
    const postsPerPage = 3; // Number of posts to show at a time on desktop
    const totalPosts = posts.length;
  
    // Function to update the carousel position
    function updateCarousel() {
      const offset = currentIndex * (100 / postsPerPage);
      postList.style.transform = `translateX(-${offset}%)`;
      postList.style.transition = "transform 0.5s ease-in-out"; // Smooth transition
  
      // Update button states
      prevButton.disabled = currentIndex === 0;
      nextButton.disabled = currentIndex >= totalPosts - postsPerPage;
  
      // Accessibility: Update ARIA attributes
      prevButton.setAttribute("aria-disabled", currentIndex === 0 ? "true" : "false");
      nextButton.setAttribute("aria-disabled", currentIndex >= totalPosts - postsPerPage ? "true" : "false");
    }
  
    // Event listeners for navigation buttons
    prevButton.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        updateCarousel();
      }
    });
  
    nextButton.addEventListener("click", () => {
      if (currentIndex < totalPosts - postsPerPage) {
        currentIndex++;
        updateCarousel();
      }
    });
  
    // Keyboard navigation for accessibility
    prevButton.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        if (currentIndex > 0) {
          currentIndex--;
          updateCarousel();
        }
      }
    });
  
    nextButton.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        if (currentIndex < totalPosts - postsPerPage) {
          currentIndex++;
          updateCarousel();
        }
      }
    });
  
    // Initial update
    updateCarousel();
  
    // Disable carousel on mobile (max-width: 600px)
    const mediaQuery = window.matchMedia("(max-width: 600px)");
    function handleMediaChange(e) {
      if (e.matches) {
        // On mobile, reset transform and transition for horizontal scrolling
        postList.style.transform = "translateX(0)";
        postList.style.transition = "none";
        prevButton.disabled = true;
        nextButton.disabled = true;
      } else {
        // On desktop, re-enable carousel
        updateCarousel();
      }
    if (!posts.length) {
      document.getElementById('post-list').innerHTML = '<p>Kh√¥ng c√≥ b√†i vi·∫øt n√†o ƒë·ªÉ hi·ªÉn th·ªã. Vui l√≤ng th·ª≠ l·∫°i sau.</p>';
    }
    // Initial check